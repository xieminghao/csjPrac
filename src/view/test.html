<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>AJAX跨域请求测试</title>
</head>
<body>
<input type='button' value='开始测试' onclick='crossDomainRequest()' />
<div id="content"></div>

<script type="text/javascript">
    //<![CDATA[

    //    function createCORSRequest(){
    //        var xhr = new XDomainRequest();
    //        return xhr;
    //    }

    function createCORSRequest(){
        var xhr;
        try {
            xhr = new XMLHttpRequest();
        }catch(e){
            xhr = new XDomainRequest();
        }
        if ("withCredentials" in xhr){

        } else if (typeof XDomainRequest != "undefined"){
            xhr = new XDomainRequest();
        } else {
            xhr = null;
        }
        return xhr;
    }
    var xhr = createCORSRequest();
    var url = 'http://120.76.188.66:8080/pk10/gethistoryandbetgame?count=20&t=0.1228310118895025&isa=1';
    function crossDomainRequest() {
        document.getElementById("content").innerHTML = "开始……";

        if (xhr) {
            xhr.open('get', url);
            xhr.onload = function() {
                alert(xhr.responseText);
            };
            xhr.send();
        } else {
            document.getElementById("content").innerHTML = "不能创建 XMLHttpRequest";
        }
    }
    function handler(evtXHR) {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                var response = xhr.responseText;
                document.getElementById("content").innerHTML = "结果：" + response;
            } else {
                document.getElementById("content").innerHTML = "不允许跨域请求。";
            }
        }
        else {
            document.getElementById("content").innerHTML += "<br/>执行状态 readyState：" + xhr.readyState;
        }
    }
</script>
</body>
</html>